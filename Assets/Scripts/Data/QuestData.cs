using System;
using System.Collections.Generic;
using AYellowpaper.SerializedCollections;
using Entities.Localization;
using Interfaces;
using TriInspector;
using UnityEngine;

namespace Data
{
    [Serializable]
    [CreateAssetMenu(fileName = "QuestData", menuName = "Configs/QuestData")]
    public class QuestData : ScriptableObject
    {
        [field: SerializeField,Title("Quest Id"),HideLabel, InfoBox("$" + nameof(HeaderPreview))] public int Id { get; private set; }
        public string HeaderPreview => LocalizationManager.GetStringFromKey("quest_header_" + Id);

        [field: Title("Scene Settings"), SerializeField, Scene] public string Scene { get; private set; }
        [field: SerializeField, Dropdown(nameof(_layers))] public int Layer { get; private set; }
        
        private int[] _layers = {0,1,2};

        [field: Title("Sequence"),SerializeField] public List<QuestElement> Sequence { get; private set; }
        
        [field: Title("Actions"), SerializeReference] public List<ISequenceAction> OnComplete{ get; private set; }
        [field: SerializeReference] public List<ISequenceAction> OnFail { get; private set; }
    }

    [Serializable]
    [DeclareHorizontalGroup("horizontal")]
    [DeclareBoxGroup("horizontal/one", Title = "Action")]
    [DeclareBoxGroup("horizontal/two", Title = "Conditions")]
    public struct QuestElement
    {
        [SerializeReference, HideLabel, Group("horizontal/one")] public ISequenceAction Action;
        [SerializeReference, HideLabel, Group("horizontal/two")] public List<ICondition> Conditions;
    }
}